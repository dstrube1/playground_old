/*
SELECT * FROM LUFeature

UPDATE LUFeature
SET Enabled = 1,
Permission_JSON = NULL
WHERE FeatureID = 22

*/

DECLARE @ClientID INT,
@SEID SMALLINT

IF OBJECT_ID('tempdb..#ClientLoop') IS NOT NULL
DROP TABLE #ClientLoop

CREATE TABLE #ClientLoop(
ClientID INT,
SEID SMALLINT,
isProcessed BIT
)

INSERT INTO #ClientLoop( ClientID, SEID, isProcessed )
VALUES (804,1,0),(3536,1,0),(3504,1,0),(3439,1,0),(4078,1,0),(4787,1,0),(3829,1,0),(3148,1,0),(3616,1,0),(166,1,0),(3615,1,0),(6288,1,0),(5257,60,0),(4347,60,0),(4303,60,0),(5386,60,0),(4867,60,0),(6394,61,0),(6464,61,0),(6417,61,0),(4455,60,0),(4702,60,0),(2625,17,0),(3995,60,0),(3996,60,0),(6303,60,0),(2748,1,0),(6815,61,0),(4952,60,0),(4336,60,0),(3999,60,0),(5384,60,0),(4465,60,0),(5969,60,0),(4616,60,0),(4730,60,0),(4001,63,0),(3945,80,0),(3943,63,0),(4481,63,0),(4286,63,0),(6477,61,0),(6396,61,0),(6427,61,0),(6380,61,0),(6344,61,0),(6424,61,0),(6805,61,0),(6467,61,0),(6357,61,0),(6418,61,0),(6465,61,0),(6441,61,0),(5810,60,0),(5991,61,0),(4378,1,0),(5467,60,0),(5425,60,0),(4464,60,0),(5426,60,0),(5428,60,0),(4098,60,0),(146,1,0),(3854,1,0),(146,17,0),(4740,1,0),(2005,1,0),(5738,1,0),(4316,60,0),(4189,1,0),(5687,60,0),(6980,60,0),(6981,60,0),(6761,60,0),(6763,60,0),(6769,60,0),(5720,60,0),(5719,60,0),(4647,60,0),(4892,61,0),(4615,60,0),(4784,60,0),(6218,60,0),(5808,60,0),(6095,60,0),(6723,61,0),(6431,61,0),(6430,61,0),(5913,60,0),(5788,60,0),(5975,60,0),(5730,60,0),(6660,1,0),(6785,60,0),(5776,1,0),(5759,61,0),(5801,63,0),(6314,1,0),(6667,1,0),(5683,1,0),(6616,1,0),(4227,1,0),(2363,1,0),(3608,1,0),(2603,1,0),(2346,1,0),(4641,1,0),(2338,1,0),(3599,1,0),(3390,1,0),(5075,60,0),(784,1,0),(6074,17,0),(6891,63,0),(6070,1,0),(6039,1,0),(6346,79,0),(6911,79,0),(2520,17,0),(3305,17,0),(5947,17,0),(5949,17,0),(2265,1,0),(2888,1,0),(3757,1,0),(3889,1,0),(3891,1,0),(3892,1,0),(3894,1,0),(3895,1,0),(4168,17,0),(2261,1,0),(3607,1,0),(2259,1,0),(2266,1,0),(2260,1,0),(2262,1,0),(2452,17,0),(4958,17,0),(4747,17,0),(4745,17,0),(6065,17,0),(5440,17,0),(5439,17,0),(2247,17,0),(2321,17,0),(5441,17,0),(5491,17,0),(4707,17,0),(4094,17,0),(5716,17,0),(6829,17,0),(2246,17,0),(4744,17,0),(5534,17,0),(4657,17,0),(5955,17,0),(5442,17,0),(4427,17,0),(4325,17,0),(4135,17,0),(4131,17,0),(4193,17,0),(4093,17,0),(4127,17,0),(4132,17,0),(4156,17,0),(3386,17,0),(2245,17,0),(5310,17,0),(5632,17,0),(4153,17,0),(3338,17,0),(2760,17,0),(2505,17,0),(4625,17,0),(5793,17,0),(2391,17,0),(5676,1,0),(3000,1,0),(4341,1,0),(2863,17,0),(5472,1,0),(5613,1,0),(5473,1,0),(6377,1,0),(5614,1,0),(5615,1,0),(5548,1,0),(4821,1,0),(4819,1,0),(4818,1,0),(4820,1,0),(4822,1,0),(4823,1,0),(6839,17,0),(5871,17,0),(4756,63,0),(6595,60,0),(6597,61,0),(5884,61,0),(6596,61,0),(5887,61,0),(6562,1,0),(4752,79,0),(4834,63,0),(3470,17,0),(4824,76,0),(6775,75,0),(5953,1,0),(4754,78,0),(4576,61,0),(6609,79,0),(5872,17,0),(6605,1,0),(3233,1,0),(4581,61,0),(4582,61,0),(6721,17,0),(4584,61,0),(6619,17,0),(4577,61,0),(4579,61,0),(4591,17,0),(3780,1,0),(4550,1,0),(2931,1,0),(3002,1,0),(5011,1,0),(2998,1,0),(4240,1,0),(2919,1,0),(3648,1,0),(3782,1,0),(4467,1,0),(5543,1,0),(5542,1,0),(5544,1,0),(6504,1,0),(5546,1,0),(5547,1,0),(5545,1,0),(5535,1,0),(5299,1,0),(4785,60,0),(5762,1,0)


WHILE EXISTS(SELECT TOP 1 1 FROM #ClientLoop WHERE isProcessed = 0)
BEGIN 

	SELECT TOP 1 @ClientID = ClientID, @SEID =SEID FROM #ClientLoop WHERE isProcessed = 0
	
	--exec SI_SP_AdminTools_ReimportClientBySearchEngine @ClientID=@ClientID,@SEID=@SEID
	
	RAISERROR('Client: %d SEID: %d Done',0,1,@ClientID, @SEID) WITH NOWAIT
	
	WAITFOR DELAY '00:00:30'
	
	UPDATE #ClientLoop
	SET isProcessed = 1
	WHERE ClientID = @ClientID
	AND SEID = @SEID

END 
